"use strict";function scrollTop(e,t){function o(t){var n;null===r&&(r=t),n=(t-r)/e,window.scrollTo(0,Math.max(c*(1-n),0)),1>n&&window.requestAnimationFrame(o)}var r=null,c=window.scrollY||document.documentElement.scrollTop;return 0==c?t():(window.requestAnimationFrame(o),setTimeout(t,e/2),void 0)}function getProjectClassName(e){return Array.prototype.slice.call(e.classList).filter(function(e){return 0===e.indexOf("project-")})[0]}function redrawProjects(){var e,t=document.querySelector(".page").getBoundingClientRect();if(e=null==document.querySelector(".m-page--project")?document.querySelectorAll(".m-project--map"):document.querySelectorAll(".m-header--project-map"),0===projectsContainer.offsetWidth)return!1;for(var o=0;o<e.length;o+=1){var r=e[o],c=getProjectClassName(r),n=document.querySelector(".js-project-list ."+c);if(!r.classList.contains("current-project")){var s=r.getBoundingClientRect(),l=document.querySelector(".js-project-list ."+c+" .m-project--card");n.style.top=s.top-t.top+"px",n.style.left=s.left-t.left+"px",n.style.width=s.width+"px",l.style.height=s.height+"px"}null!=document.querySelector(".m-page--project")&&(r.classList.contains("current-project")?n.classList.remove("project-small"):n.classList.add("project-small"))}}function loadProjectContent(e){var t=new XMLHttpRequest,o=+new Date;t.onreadystatechange=function(r){if(4===t.readyState){var c=document.querySelector(".project-"+e+" .m-project--content"),n=+new Date;clearTimeout(projectContentTimer),projectContentTimer=setTimeout(function(){c.innerHTML=r.target.response,c.classList.remove("project-content-loading"),c.appendChild(footer.cloneNode(!0)),document.querySelector(".project-"+e+" .scroll-to-top").addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),scrollTop(400)},!0),setTimeout(function(){var t=plyr.setup(".project-"+e+" .m-project--content .js-plyr");t&&(videos=videos.concat(t))},1e3)},Math.max(1e3-(n-o),0))}},t.open("GET","parts/"+e+".html",!0),t.send()}function pauseAllVideos(){for(var e in videos)videos.hasOwnProperty(e)&&videos[e].pause()}function projectLinkClick(e){e.preventDefault(),e.stopPropagation(),pauseAllVideos();var t=this;scrollTop(150,function(){var e=document.querySelector(".m-header--project-map.current-project"),o=getProjectClassName(t.parentNode);null!=e&&e.classList.remove("current-project"),document.querySelector(".m-header--project-map."+o).classList.add("current-project");var r=document.querySelector(".m-projects .current-project");null!=r&&r.classList.remove("current-project"),t.parentNode.classList.add("current-project");var c=document.querySelector(".m-projects .last-current-project");null!=c&&c.classList.remove("last-current-project"),t.parentNode.classList.add("last-current-project"),document.querySelector(".page").classList.add("m-page--project"),redrawProjects();var n=document.querySelector(".project-"+o.replace("project-","")+" .m-project--content");n.classList.add("project-content-loading"),"private"==o.replace("project-","")&&locked||(0===n.innerHTML.trim().length?loadProjectContent(o.replace("project-","")):(clearTimeout(projectContentTimer),projectContentTimer=setTimeout(function(){n.classList.remove("project-content-loading")},1200)))})}function projectOver(){this.parentNode.classList.contains("project-small")&&document.querySelector(".m-header-project--infos ."+getProjectClassName(this.parentNode)).classList.add("hovered-project")}function projectOut(){for(var e=document.querySelectorAll(".m-header-project--infos > div"),t=0;t<e.length;t+=1)e[t].classList.remove("hovered-project")}function slideOnScroll(){for(var e=document.querySelectorAll(".current-project .slide-on-scroll"),t=0;t<e.length;t+=1){var o=e[t].getBoundingClientRect();o.top-window.innerHeight<0?e[t].classList.remove("rewind-slide"):o.top-window.innerHeight-20>0&&e[t].classList.add("rewind-slide")}}"ontouchstart"in document.documentElement&&document.body.classList.add("has-touch");var locked="false"!==localStorage.getItem("locked");window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;for(var email=["mailto",":","adrien",".","gervaix","@","gmail",".","com"].join(""),emailElements=document.querySelectorAll(".js-email"),e=0;e<emailElements.length;e+=1)emailElements[e].href=email;var projectsContainer=document.querySelector(".m-projects");window.addEventListener("resize",redrawProjects,!1),window.onload=function(){document.body.classList.add("loaded");for(var e=document.querySelectorAll("[data-src]"),t=0;t<e.length;t+=1)e[t].src=e[t].dataset.src;setTimeout(function(){document.body.classList.add("loaded-projects"),redrawProjects()},2500)};var videos=[],footer=document.querySelector(".js-project-footer").cloneNode(!0);footer.classList.remove("js-project-footer");for(var projectContentTimer,projectLinks=document.querySelectorAll(".m-project--link"),i=0;i<projectLinks.length;i+=1)projectLinks[i].addEventListener("click",projectLinkClick,!1),projectLinks[i].addEventListener("mouseover",projectOver,!1),projectLinks[i].addEventListener("mouseout",projectOut,!1);window.addEventListener("scroll",slideOnScroll),window.addEventListener("resize",slideOnScroll);for(var closeButtons=document.querySelectorAll(".js-close-project"),c=0;c<closeButtons.length;c+=1)closeButtons[c].addEventListener("click",function(){pauseAllVideos();var e=document.querySelectorAll(".project-small"),t=document.querySelectorAll(".current-project");document.querySelector(".current-project .m-project--content").innerHTML="";for(var o=0;o<e.length;o+=1)e[o].classList.remove("project-small");for(var r=0;r<t.length;r+=1)t[r].classList.remove("current-project");document.querySelector(".page").classList.remove("m-page--project"),redrawProjects()},!1);document.querySelector(".toggle-about").addEventListener("click",function(){document.body.classList.toggle("about"),redrawProjects()},!1);var PASSWORD="96fe8810c091dfa2ea90c8af878ee9b2";document.querySelector(".project-password").addEventListener("submit",function(e){e.preventDefault(),e.stopPropagation(),document.getElementById("password").classList.remove("errored"),md5(document.getElementById("password").value)===PASSWORD?(document.querySelector(".locked").classList.remove("locked"),locked=!1,localStorage.setItem("locked",!1),loadProjectContent("private")):document.getElementById("password").classList.add("errored")},!1),locked||document.querySelector(".locked").classList.remove("locked");